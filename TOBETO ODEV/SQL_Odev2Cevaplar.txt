--61. En çok satılan ürünümün(adet bazında) adı, kategorisinin adı ve tedarikçisinin adı
Select p.product_name, c.category_name, s.company_name, od.quantity From public.products
as p JOIN public.categories as c on p.category_id = c.category_id
JOIN public.suppliers as s on p.supplier_id = s.supplier_id
join public.order_details as od on od.product_id = p.product_id
order by quantity desc limit 1;

--62. Kaç ülkeden müşterim var
select count(distinct country) from customers;

--63. Hangi ülkeden kaç müşterimiz var
select count(customer_id), country from customers
group by country;

--64. 3 numaralı ID ye sahip çalışan (employee) son Ocak ayından BUGÜNE toplamda ne kadarlık ürün sattı?
Select SUM(od.quantity * od.unit_price) from orders o
INNER JOIN employees e ON o.employee_id = e.employee_id
INNER JOIN order_details od ON od.order_id = o.order_id
WHERE e.employee_id =3 AND order_date >= '1998.01.01'

--65. 10 numaralı ID ye sahip ürünümden son 3 ayda ne kadarlık ciro sağladım?
select od.product_id, sum(od.quantity * od.unit_price) from order_details od
join orders o on od.order_id = o.order_id
where od.product_id = 10 and o.order_date >= date '1998-05-31' - INTERVAL '3 months'
group by od.product_id;
--2.yolu--
Select SUM(od.quantity * od.unit_price) from orders o
INNER JOIN order_details od ON od.order_id = o.order_id
WHERE od.product_id =10 and o.order_date between '1998.03.01' and '1998.05.06';

--66. Hangi çalışan şimdiye kadar toplam kaç sipariş almış..?
select o.employee_id, sum(quantity) from orders o
join order_details od on o.order_id = od.order_id
group by o.employee_id;

--67. 91 müşterim var. Sadece 89’u sipariş vermiş. Sipariş vermeyen 2 kişiyi bulun
SELECT company_name, order_id FROM orders O 
RIGHT JOIN customers c ON C.customer_id=O.customer_id
WHERE o.order_id IS NULL ORDER BY company_name ASC;

--68. Brazil’de bulunan müşterilerin Şirket Adı, TemsilciAdi, Adres, Şehir, Ülke bilgileri
SELECT  company_name, contact_name, address ,city, country FROM customers
WHERE Country='Brazil' ORDER BY company_name;

--69. Brezilya’da olmayan müşteriler
SELECT  company_name, contact_name, address ,city, country
FROM customers WHERE Country!='Brazil' ORDER BY company_name;

--70. Ülkesi (Country) YA Spain, Ya France, Ya da Germany olan müşteriler
SELECT  company_name, country FROM customers
WHERE country='Spain' OR country='France' OR country='Germany'
ORDER BY Country;

--71. Faks numarasını bilmediğim müşteriler
SELECT  company_name FROM customers
WHERE Fax IS NULL ORDER BY company_name;

--72. Londra’da ya da Paris’de bulunan müşterilerim
SELECT  company_name, contact_name, address ,city, country FROM customers
WHERE city='London' OR city='Paris';

--73. Hem Mexico D.F’da ikamet eden HEM DE ContactTitle bilgisi ‘owner’ olan müşteriler
SELECT  company_name, contact_name, address ,city, country FROM customers
WHERE city='México D.F.' AND contact_title ='Owner';

--74. C ile başlayan ürünlerimin isimleri ve fiyatları
SELECT  Product_Name, Unit_Price FROM Products
WHERE Product_Name LIKE 'C%';

--75. Adı (FirstName) ‘A’ harfiyle başlayan çalışanların (Employees); Ad, Soyad ve Doğum Tarihleri
SELECT  First_Name, Last_Name, Birth_Date FROM Employees
WHERE First_Name LIKE 'A%';

--76. İsminde ‘RESTAURANT’ geçen müşterilerimin şirket adları
SELECT  company_name FROM customers
WHERE company_name LIKE '%Restaurant%';

--77. 50$ ile 100$ arasında bulunan tüm ürünlerin adları ve fiyatları
SELECT  Product_Name, Unit_Price FROM Products
WHERE Unit_Price BETWEEN 50 AND 100;

--78. 1 temmuz 1996 ile 31 Aralık 1996 tarihleri arasındaki siparişlerin (Orders), SiparişID (OrderID) ve SiparişTarihi (OrderDate) bilgileri
SELECT  Order_ID, Order_Date FROM Orders
WHERE Order_Date BETWEEN '1996-07-01' AND '1996-12-31' ;

--79. Ülkesi (Country) YA Spain, Ya France, Ya da Germany olan müşteriler
SELECT Country, Company_Name FROM Customers
WHERE Country='Spain' OR Country='France' OR Country='Germany'
ORDER BY Country ASC;

--80. Faks numarasını bilmediğim müşteriler
SELECT Company_Name FROM Customers
WHERE Fax IS NULL
ORDER BY Company_Name ASC;

--81. Müşterilerimi ülkeye göre sıralıyorum:
SELECT DISTINCT Country, Company_Name FROM Customers
ORDER BY Country ASC;

--82. Ürünlerimi en pahalıdan en ucuza doğru sıralama, sonuç olarak ürün adı ve fiyatını istiyoruz
SELECT Product_Name, Unit_Price FROM Products
ORDER BY Unit_Price DESC;

--83. Ürünlerimi en pahalıdan en ucuza doğru sıralasın, ama stoklarını küçükten-büyüğe doğru göstersin sonuç olarak ürün adı ve fiyatını istiyoruz
SELECT Product_Name, Unit_Price, Units_In_Stock FROM Products
ORDER BY Unit_Price DESC, Units_In_Stock ASC;

--84. 1 Numaralı kategoride kaç ürün vardır..?
SELECT COUNT(*) Product_Name FROM Products
WHERE Category_id=1;

--85. Kaç farklı ülkeye ihracat yapıyorum..?
SELECT COUNT(DISTINCT Country) FROM Customers;
